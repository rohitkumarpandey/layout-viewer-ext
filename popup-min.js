class TabConfig{constructor(e,t,i){this.tabId=e,this.deviceId=t,this.orientation=i}getTabId(){return this.tabId}getDeviceId(){return this.deviceId}getOrientation(){return this.orientation}setOrientation(e){this.orientation=e}setDeviceId(e){this.deviceId=e}setTabId(e){this.tabId=e}}class TabConfigService{constructor(){this.tabConfigs=new Map}addTabConfig(e){this.tabConfigs.set(`tabId-${e.getTabId()}`,e),this.#e(this.tabConfigs)}deleteTabConfig(e){this.tabConfigs.delete(`tabId-${e}`),this.#e(this.tabConfigs)}async getTabConfigs(){return this.tabConfigs=await this.#t(),this.tabConfigs}#i(e,t){chrome.runtime.sendMessage(e,{},t)}#e(e){this.#i({action:"session_storage",perform:"SET",data:{tabconfig:JSON.stringify(Array.from(e.entries()))}},(()=>{}))}async#t(){return await new Promise((e=>{this.#i({action:"session_storage",perform:"GET",data:{key:"tabconfig"}},(t=>{e(new Map(JSON.parse(t.tabconfig)))}))}))}}class DeviceOption{constructor(e,t,i,n,a=!0){this.id=e,this.name=t,this.height=i,this.width=n,this.enabled=a}getPortraitMode(){return{name:this.name,height:this.height,width:this.width}}getLandScapeMode(){return{name:this.name,height:this.width,width:this.height}}}class AppManager{constructor(e,t=1){this.deviceOptions=e,this.tabs=t,this.tabConfigService=new TabConfigService}setDeviceOptions(e){const t=document.getElementsByClassName("lv-page-header"),i=document.createElement("div");i.className="lv-page-header-left";const n=document.createElement("div");n.className="lv-page-header-middle";const a=document.createElement("div");a.className="lv-page-header-right";const s=document.createElement("img");s.id=`rotate-device-${e}`,s.src="./assets/rotate-device.png",s.setAttribute("data-app",`rotate-device-${e}`);const o=document.createElement("div");o.id=`lv-page-resolution-${e}`,o.className="lv-page-resolution";const d=this.deviceOptions[0];o.innerText=`${d.width} x ${d.height}`;const c=document.createElement("div");c.innerHTML="&#x2715;",c.className="close-tab-btn",c.setAttribute("data-app",`close-tab-btn-${e}`);const r=document.createElement("select");r.className="lv-device-dropdown",r.id=`section-dropdown-${e}`,r.setAttribute("data-app",`section-dropdown-${e}`),this.deviceOptions.forEach((t=>{if(t.enabled){const i=document.createElement("option");i.innerText=t.name,i.value=t.id,i.className="lv-device-option",i.setAttribute("data-app",`section-options-${e}`),r.appendChild(i)}})),n.appendChild(s),n.appendChild(r),n.appendChild(o),a.appendChild(c),[...t].forEach((e=>{e.appendChild(i),e.appendChild(n),e.appendChild(a)})),s.addEventListener("click",(()=>{const e=""+s.getAttribute("data-app"),t=e[e.length-1],i=(""+document.getElementById(`section-${t}`).getAttribute("data-app")).split("-")[2]||"portrait",n=document.getElementById(`section-dropdown-${t}`).value,a=this.deviceOptions.find((e=>e.id===n));if(n&&a){const e="portrait"===i?"landscape":"portrait";this.changeDevice(n,t,e)}})),r.addEventListener("change",(()=>{const e=""+r.getAttribute("data-app"),t=e[e.length-1];this.changeDevice(r.value,t)})),c.addEventListener("click",(()=>{const e=""+c.getAttribute("data-app"),t=e[e.length-1],i=document.getElementById(`section-${t}`);i&&(i.parentNode.removeChild(i),this.tabConfigService.deleteTabConfig(t))}))}setSection(e){const t=document.getElementsByClassName("lv-sections"),i=document.createElement("div");i.id=`section-${e}`,i.className="lv-section",i.setAttribute("data-app",`section-${e}-portrait`);const n=document.createElement("div");n.className="lv-page-header";const a=document.createElement("div");a.className="lv-section-tab",a.setAttribute("data-app",`tab-${e}`);const s=document.createElement("iframe");s.src="/pages/page.html",s.id=`iframe-${e}`,a.appendChild(s),i.appendChild(n),i.appendChild(a),[...t].forEach((e=>e.appendChild(i))),this.setDeviceOptions(e)}addTabs(){this.setSection(++this.tabs),this.setDefaultConfig()}addTab(e){this.tabs=e.getTabId(),this.setSection(e.getTabId()),this.changeDevice(e.getDeviceId(),e.getTabId(),e.getOrientation(),!1)}changeDevice(e,t,i="portrait",n=!0){const a=document.getElementById(`iframe-${t}`),s=this.deviceOptions.find((t=>t.id===e));if(s){let o;o="portrait"===i?s.getPortraitMode():s.getLandScapeMode();document.getElementById(`lv-page-resolution-${t}`).innerText=`${o.width} x ${o.height}`,a.style.maxHeight=o.height,a.style.maxWidth=o.width,a.style.minHeight=o.height,a.style.minWidth=o.width;document.getElementById(`section-${t}`).setAttribute("data-app",`section-${t}-${i}`);if(document.getElementById(`section-dropdown-${t}`).value=e,n){const n=new TabConfig(t,e,i);this.tabConfigService.addTabConfig(n)}}}setDefaultConfig(){const e=this.deviceOptions[0];this.changeDevice(e.id,this.tabs)}bindEvents(){const e=document.getElementById("add-tab-btn");e&&e.addEventListener("click",(()=>{this.addTabs()}))}async loadTabs(){const e=await this.tabConfigService.getTabConfigs();e.size>0?e.forEach((e=>{const t=new TabConfig(e.tabId,e.deviceId,e.orientation);this.addTab(t)})):(this.setSection(this.tabs),this.setDefaultConfig())}init(){this.loadTabs(),this.bindEvents()}}document.addEventListener("DOMContentLoaded",(()=>{const e=new DeviceOption("iphone-se","iPhone SE",667,375),t=new DeviceOption("iphone-xr","iPhone XR",896,414),i=new DeviceOption("iphone-12-pro","iPhone 12 Pro",884,390),n=new DeviceOption("iphone-14-pro-max","iPhone 14 Pro Max",932,430),a=new DeviceOption("pixel-7","Pixel 7",915,412),s=new DeviceOption("samsung-galaxy-s8-plus","Samsung Galaxy S8+",740,360),o=new DeviceOption("samsung-galaxy-s20-ultra","Samsung Galaxy S20 Ultra",915,412),d=new DeviceOption("ipad-mini","iPad Mini",1024,768),c=new DeviceOption("ipad-air","iPad Air",1180,820),r=new DeviceOption("ipad-pro","iPad Pro",1366,1024),h=new DeviceOption("surface-pro-7","Surface Pro 7",1368,812),p=new DeviceOption("surface-duo","Surface Duo",720,540),g=new DeviceOption("galaxy-z-fold-5","Galaxy Z Fold 5",882,344),l=new DeviceOption("asus-zenbook-fold","Asus Zenbook Fold",1280,853),m=new DeviceOption("samsung-galaxy-a15-17","Samsung Galaxy A51/71",914,412),b=new DeviceOption("nest-hub","Nest Hub",600,1024),v=new DeviceOption("nest-hub-max","Nest Hub Max",800,1280);new AppManager([e,t,i,n,a,s,o,d,c,r,h,p,g,l,m,b,v]).init()}));